# LOTTER
программа для анализа результатов лотереи  «Спортлото 6/49»

### УСЛОВИЕ ВЫПОЛНЕНИЯ ПРОГРАММЫ
* программа написана на языке Python, версия 3
* **Lotter** выводит результаты своей работы в окно терминала
* для обработки и анализа данных используются дополнительные библиотеки Pandas, Numpy, Matplotlib
* основной файл программы - 'lotter.py'
* в том же директории, в котором находится файл 'lotter.py', должны размещаться файлы: 
    - 'lotter_func.py' - функции, используемые программой
    - 'lotter.ini' - используемые программой параметры (настройки)
    - 'lotter_results.xlsx' - архив тиражей лотереи, подробности - ниже
    - остальные файлы 'временные' и формируются / обновляются в ходе работы программы
* файл 'lotter.ini' может быть отредактирован пользователем, в нём задаётся
    - разновидность игры: '6 из 49' (установлено по умолчанию)
    - сколько последних тиражей нужно проанализировать
* остальные файлы - 'временные' и формируются в ходе работы программы
* файл 'lotter_console.txt' демонстрирует актуальный вывод программы в консоль.

### АЛГОРИТМ РАБОТЫ ПРОГРАММЫ
1. На старте **Lotter** считывает из файла 'loter.ini' нужные параметры: 'разновидность игры' и 'сколько последних тиражей нужно анализировать'. Возможность работы с файлами *.ini заложена в **Lotter**, в том числе, и на перспективу - для реализации в программе возможности анализа архивов тиражей и других лотерей (например, '5 из 36').
1. После старта **Lotter** определяет, есть ли в этом же директории файл с актуальным архивом тиражей. Программа предполагает, что его имя 'loter_results.xlsx'. Файл с архивом тиражей должен быть предварительно загружен с официального сайта лотереи. Там он формируется автоматически, ему присваивается имя в формате 'game results 6-49 (дд.мм.гггг чч_мм_сс).xlsx'. **Lotter** осуществит поиск по директории и переименует такой файл в 'loter_results.xlsx'. При наличии нескольких файлов с разными временными метками, переименован будет только 'самый новый' из них. Все другие файлы архивов, в том числе 'старый' файл 'loter_results.xlsx' (при его наличии) будут удалены.
1. Фиксируется текущая дата. **Lotter** использует её в начале формирования отчёта и для расчётов 'сколько дней назад выпадал номер'.
1. В терминал выводится 'легенда' - перечень условных сокращений, которые будут использоваться в отчёте.
1. С использованием функционала библиотеки Pandas, **Lotter** читает данные из архива тиражей 'loter_results.xlsx'. \
Для архива лотереи '6 из 49' Exel использует 18 столбцов от 'A' до 'R' с названиями: 'Тираж', 'Дата', 'Шар 1', 'Шар 1', 'Шар 3', 'Шар 4', 'Шар 5', 'Шар 6', '6 чисел угадали', 'Выигрыш', '5 чисел угадали', 'Выигрыш', '4 числа угадали', 'Выигрыш', '3 числа угадали', 'Выигрыш', 'Джек-пот', 'Призовой фонд'. \
Неприятным моментом здесь является то, что сразу несколько столбцов имеют одно и то же название 'Выигрыш'. Pandas корректно прочитает только один из таких столбцов, данные из других - пропадут. Чтобы такой ошибки не происходило, **Lotter** будет забирать из столбцов архива тиражей только нужные данные, а названия столбцов изменит на другие, 'кастомные', без каких-либо повторов.
1. В соответствии с пунктом 5, с использованием 'loter_results.xlsx' формируется файл 'loter_results.csv'
1. Расчёт общей статистики полной базы тиражей.
1. Подробный отчёт по результатам последнего тиража.
1. Вывод кратких результатов нескольких (количество определяется пользователем в файле 'loter.ini') последних тиражей. Для удобства выполнена обратная сортировка результатов (последний тираж - в первой строке, предпоследний - во второй и т.д.) 

### ПРАВИЛА ИГРЫ 'СПОРТЛОТО 6 ИЗ 49'
*официальный текст по состоянию на 05.05.2025* \
«Спортлото 6/49» - электронная интерактивная игра, аналог советского «Спортлото 6/49». \
В ходе розыгрыша из лототрона, в котором находится 49 шаров с номерами от 1 до 49, случайным образом выпадают 6 шаров, образующих призовую комбинацию. Цель игры - угадать как можно больше выпавших в лототроне чисел. Участник, угадавший все 6 выпавших шаров, становится обладателем джекпота! \
Сделать ставку просто: Выберите 6 чисел из 49, отметив соответствующие значения в игровом поле. Вы можете заполнить несколько игровых полей и/или выбрать несколько розыгрышей, в которых ваша комбинация (комбинации) будет принимать участие. Стоимость участия в игре определяется путем умножения стоимости одной комбинации (4 рубля) на выбранное количество комбинаций и количество розыгрышей. \
В ходе розыгрыша из лототрона, в котором находится 49 шаров с номерами от 1 до 49, случайным образом выпадают 6 шаров, образующих призовую комбинацию. Процесс происходит автоматически без участия человека и без возможности повлиять на результаты розыгрыша. Розыгрыши проводятся в присутствии тиражной комиссии, которая фиксирует порядок выпадения шаров в протоколе. \
Розыгрыши «Спортлото 6 из 49» проходят 4 раза в неделю в эфире телеканала «Беларусь 2», а также на YouTube-канале компании. \
Время проведения розыгрышей: понедельник, вторник, четверг и суббота - в 21:10. \
Приём ставок прекращается в день проведения розыгрыша в 20:50. \
Время проведения розыгрышей может смещаться по эфирной сетке из-за трансляций спортивных мероприятий. \
Минимальный выигрыш - 3 угаданных числа. Выигрыш 3 из 6 является фиксированным и на данный момент составляет 20 рублей. Выплаты за совпадение 4 и более чисел формируются в зависимости от общего количества ставок, сделанных участниками. Средства призового фонда распределяются следующим образом: \
    - совпадение 6 чисел (джекпот, 1 категория) - 35% выигрышного фонда тиража; \
    - совпадение 5 чисел (2 категория) - 50% от разницы выигрышного фонда тиража и выплат за первую и четвертую категории данного тиража; \
    - совпадение 4 чисел (3 категория) - 50% от разницы выигрышного фонда тиража и выплат за первую и четвертую категории данного тиража; \
    - совпадение 3 чисел (4 категория) - фиксированная выплата, установленная организатором.\
Джекпот формируется за счёт средств доли категории 1, которые переходят из тиража в тираж до тех пор, пока в данной категории не появится хотя бы один победитель. \
Результаты тиражей можно узнать на сайте и в мобильном приложении, в точках продаж ЗАО «Спорт-пари», а также по телефону Горячей линии 143. \
Результаты тиража становятся доступны на сайте и в мобильном приложении в течение 10-30 минут после прямого эфира. \
Выплата выигрышей начинается не позднее 11:00 дня, следующего за днём проведения розыгрыша призового фонда тиража. \
Выигрыш за ставки, сделанные на сайте и в мобильном приложении, можно получить перечислением на банковскую карту (данная опция станет доступна в ближайшее время), которая была привязана к игровому аккаунту, либо зачислить на игровой счёт. Обратите внимание, что деньги, зачисленные на игровой счёт, не подлежат выплате и предназначены только для оплаты ставок. Также выигрыши в игре в зависимости от его размера можно получить наличными в фирменных точках продаж компании «Спорт-пари» и на некоторых дилерских точках продаж. \
Расположение ближайших точек продаж «Спорт-пари», где возможно получить выигрыш, можно узнать по телефону Горячей линии 143. \
Чек-прогноз принимается к оплате в течение 6 месяцев, начиная со дня проведения розыгрыша призового фонда тиража. \

### ТЕРМИНЫ И ОПРЕДЕЛЕНИЯ
*для расширения кругозора*
- **андерсемплинг** - способ, когда мажоритарный класс уменьшают. Проще всего убрать случайные значения, но чаще уменьшение опять же делается так, чтобы не нарушить соотношения;
- **байесианская вероятность**  - теорема Байеса помогает подсчитать вероятность события с учетом каких-то гипотетических новых факторов. Классическая вероятность считается только с учетом так называемых априорных факторов: тех, что даны изначально. Если в процессе появится новое предположение или гипотеза, классическая вероятность это не учтёт. А байесианская  - учтёт;
- **выборка** - определенный набор данных, который отражает реальную ситуацию. Выборка должна быть репрезентативной. Это значит, что в ней нужно передать реальную картину происходящего - в статистике говорят «свойства генеральной совокупности»;
- **выделение признаков** - это разновидность абстрагирования, процесс «снижения размерности», в котором исходный набор исходных переменных сокращается до более управляемых групп (признаков) для дальнейшей обработки, оставаясь при этом достаточным набором для точного и полного описания исходного набора данных;
- **дисперсия** - уровень разброса значений относительно определенной точки. В качестве точки может выступать среднее, медиана, истинное или целевое значение - зависит от ситуации. Если все данные в выборке близки к этой точке, то дисперсия «низкая». Тогда говорят, что у данных высокая кучность. А если результаты «разбросаны» в большом диапазоне относительно точки, то дисперсия «высокая»;
- **корреляция** - явление, когда изменение одного показателя похоже на изменение другого показателя. Например, один растёт, другой растёт. Или один растёт, другой падает - обратная корреляция. Линейная корреляция - один показатель меняется, другой меняется пропорционально первому. Нелинейная корреляция - показатели меняются непропорционально друг другу, а, например, экспоненциально;
- **мажоритарный класс данных** - класс большего размера;
- **медиана** - «серединное» значение. Если построить все данные в ряд по возрастанию, медианное значение окажется ровно посреди ряда: одна половина значений меньше, а другая половина больше. Медиана отличается от среднего тем, что не так чувствительна к аномально высоким или аномально низким значениям;
- **минимум и максимум** - самое маленькое и самое большое значения;
- **миноритарный класс данных** - класс меньшего размера;
- **мода** - значение, которое встречается в выборке чаще всего;
- **нормальное распределение** - встречается чаще всего. Распределение на графике выглядит как холм, который называют «колоколом Гаусса» или «гауссианой». Колокол показывает: вероятность получить «среднее» значение больше всего. Чем больше отклонение от среднего, тем ниже вероятность. Для самых низких или высоких значений вероятность особенно низкая. Колокол может быть сдвинут влево или вправо относительно среднего - по медиане;
- **оверсемплинг** - способ, когда данные в минориторном классе клонируют, чтобы их стало больше. Причем клонируют так, чтобы не нарушить изначальные соотношения значений и распределение;
- **отбор признаков** - с помощью формул и векторных преобразований специалисты решают, какие признаки связаны с результатом или целевым показателем, а какие нет. Незначительные признаки отбрасывают;
- **проекция признаков** - показатели представляют на графике, а потом уменьшают размерность этого графика. Например, изначально он трёхмерный - его делают двумерным. Некоторые точки трёхмерного графика накладываются друг на друга и в двумерной версии выглядят как одна точка. Переменных становится меньше;
- **процентили**, **перцентили** - по смыслу похожи на медиану, но находятся не посередине. Например, 25 перцентиль означает, что 25% значений в выборке меньше него, а остальные больше;
- **равномерное распределение** - когда есть конкретные диапазоны значений со статичной вероятностью. График распределения состоит из прямых, горизонтальных и вертикальных линий;
- **размах** - разница между минимумом и максимумом;
- **распределение Пуассона** - в некоторых случаях очень похоже на нормальное. Распределение используют для анализа количества событий за определенный промежуток времени. События должны быть не связаны друг с другом. У распределения Пуассона есть дополнительный показатель интенсивности, который влияет на форму графика: чем интенсивность выше, тем больше распределение становится похожим на «гауссиану»;
- **репрезентативность** - это характеристика, показывающая, что отобранные объекты, представители, части, элементы по своему содержанию, характеристикам соответствуют полной совокупности, массиву данных или аудитории людей, из которых их отобрали;
- **репрезентативный** - дающий объективное представление о чём-либо, являющийся типичным представителем большого количества, совокупности чего-либо;
- **семплирование или семплинг** - набор методов, которые помогают сделать выборку релевантной. Семплирование помогает составить правила для отбора данных в выборку. У него две главных цели: репрезентативность (выборка отражает реальную ситуацию) и полнота (данных хватает для полноценного анализа);
- **смещение** - нежелательные связи между данными - то, насколько данные и выводы из них «смещены» относительно реальной ситуации;
- **снижение размерности** - набор техник преобразования данных, направленных на уменьшение числа переменных путём выявления главных переменных. В общем случае снижение размерности может быть разделено на «отбор признаков» и «выделение признаков»;
- **среднее** - имеется в виду среднее арифметическое, когда все значения складывают и делят на их количество. В отличие от медианы, не учитывает разброс.


